
namespace MauMau {

    interface Spielkarte {
        zahl: string;
        //rot: boolean;
        farbe: string;
        symbol: string;
        karten_wert_symbol: string;
        //zwei_ziehen: boolean; 
        //aussetzten: boolean;
        //wünschen: boolean;
    //allesleger: boolean;
    }

    let karte01: Spielkarte = {
        zahl: "7",
        //rot: true,
        farbe: "rot",
        symbol: "♦",
        karten_wert_symbol: "1"
    };

    let karte02: Spielkarte = {
        zahl: "8",
        //rot: true,
        farbe: "rot",
        symbol: "♦",
        karten_wert_symbol: "1"
    };

    let karte03: Spielkarte = {
        zahl: "9",
        //rot: true,
        farbe: "rot",
        symbol: "♦",
        karten_wert_symbol: "1"
    };

    let karte04: Spielkarte = {
        zahl: "10",
        //rot: true,
        farbe: "rot",
        symbol: "♦",
        karten_wert_symbol: "1"
    };

    let karte05: Spielkarte = {
        zahl: "Bube",
        //rot: true,
        farbe: "rot",
        symbol: "♦",
        karten_wert_symbol: "1"
    };

    let karte06: Spielkarte = {
        zahl: "Dame",
        //rot: true,
        farbe: "rot",
        symbol: "♦",
        karten_wert_symbol: "1"
    };

    let karte07: Spielkarte = {
        zahl: "Koenig",
        //rot: true,
        farbe: "rot",
        symbol: "♦",
        karten_wert_symbol: "1"
    };

    let karte08: Spielkarte = {
        zahl: "Ass",
        //rot: true,
        farbe: "rot",
        symbol: "♦",
        karten_wert_symbol: "1",
    }

    let karte09: Spielkarte = {
        zahl: "7",
        //rot: true,
        farbe: "rot",
        symbol: "♥",
        karten_wert_symbol: "2",
    }

    let karte10: Spielkarte = {
        zahl: "8",
        //rot: true,
        farbe: "rot",
        symbol: "♥",
        karten_wert_symbol: "2",
    }

    let karte11: Spielkarte = {
        zahl: "9",
        //rot: true,
        farbe: "rot",
        symbol: "♥",
        karten_wert_symbol: "2",
    }

    let karte12: Spielkarte = {
        zahl: "10",
        //rot: true,
        farbe: "rot",
        symbol: "♥",
        karten_wert_symbol: "2",
    }

    let karte13: Spielkarte = {
        zahl: "Bube",
        //rot: true,
        farbe: "rot",
        symbol: "♥",
        karten_wert_symbol: "2",
    }

    let karte14: Spielkarte = {
        zahl: "Dame",
        //rot: true,
        farbe: "rot",
        symbol: "♥",
        karten_wert_symbol: "2",
    }
    

    let karte15: Spielkarte = {
        zahl: "Koenig",
        //rot: true,
        farbe: "rot",
        symbol: "♥",
        karten_wert_symbol: "2",
    }

    let karte16: Spielkarte = {
        zahl: "Ass",
        //rot: true,
        farbe: "rot",
        symbol: "♥",
        karten_wert_symbol: "2",
    }

    let karte17: Spielkarte = {
        zahl: "7",
        //rot: false,
        farbe: "schwarz",
        symbol: "♠",
        karten_wert_symbol: "3",
    }

    let karte18: Spielkarte = {
        zahl: "8",
        //rot: false,
        farbe: "schwarz",
        symbol: "♠",
        karten_wert_symbol: "3",
    }

    let karte19: Spielkarte = {
        zahl: "9",
        //rot: false,
        farbe: "schwarz",
        symbol: "♠",
        karten_wert_symbol: "3",
    }

    let karte20: Spielkarte = {
        zahl: "10",
        //rot: false,
        farbe: "schwarz",
        symbol: "♠",
        karten_wert_symbol: "3",
    }

    let karte21: Spielkarte = {
        zahl: "Bube",
        //rot: false,
        farbe: "schwarz",
        symbol: "♠",
        karten_wert_symbol: "3",
    }

    let karte22: Spielkarte = {
        zahl: "Dame",
        //rot: false,
        farbe: "schwarz",
        symbol: "♠",
        karten_wert_symbol: "3",
    }

    let karte23: Spielkarte = {
        zahl: "Koenig",
        //rot: false,
        farbe: "schwarz",
        symbol: "♠",
        karten_wert_symbol: "3",
    }

    let karte24: Spielkarte = {
        zahl: "Ass",
        //rot: false,
        farbe: "schwarz",
        symbol: "♠",
        karten_wert_symbol: "3",
    }

    let karte25: Spielkarte = {
        zahl: "7",
        //rot: false,
        farbe: "schwarz",
        symbol: "♣",
        karten_wert_symbol: "4",
    }

    let karte26: Spielkarte = {
        zahl: "8",
        //rot: false,
        farbe: "schwarz",
        symbol: "♣",
        karten_wert_symbol: "4",
    }

    let karte27: Spielkarte = {
        zahl: "9",
        //rot: false,
        farbe: "schwarz",
        symbol: "♣",
        karten_wert_symbol: "4",
    }

    let karte28: Spielkarte = {
        zahl: "10",
        //rot: false,
        farbe: "schwarz",
        symbol: "♣",
        karten_wert_symbol: "4",
    }

    let karte29: Spielkarte = {
        zahl: "Bube",
        //rot: false,
        farbe: "schwarz",
        symbol: "♣",
        karten_wert_symbol: "4",
    }

    let karte30: Spielkarte = {
        zahl: "Dame",
        //rot: false,
        farbe: "schwarz",
        symbol: "♣",
        karten_wert_symbol: "4",
    }

    let karte31: Spielkarte = {
        zahl: "Koenig",
        //rot: false,
        farbe: "schwarz",
        symbol: "♣",
        karten_wert_symbol: "4",
    }

    let karte32: Spielkarte = {
        zahl: "Ass",
        //rot: false,
        farbe: "schwarz",
        symbol: "♣",
        karten_wert_symbol: "4",
    }

    //Arrays

    let ziehstapel: Spielkarte[] = [karte01, karte02, karte03, karte04, karte05, karte06, karte07, karte08, karte09, karte10, karte11, karte12, karte13, karte14, karte15, karte16, karte17, karte18, karte19, karte20, karte21, karte22, karte23, karte24, karte25, karte26, karte27, karte28, karte29, karte30, karte31, karte32];

    let handstapel: Spielkarte[] = [];

    let spielstapel: Spielkarte[] = [];

    document.addEventListener("DOMContentLoaded", anzahlHandkarten);
    document.addEventListener("DOMContentLoaded", init);
    document.addEventListener("DOMContentLoaded", definieren);
    //document.addEventListener("DOMContentLoaded", keydown)

    function anzahlHandkarten(): void {
        let base: number = 10;
        let promptValue: string = prompt("Anzahl der Karten eingeben");
        let anzahl: number = parseInt(promptValue, base);
        kartenInHandstapel(anzahl);
    }

    function kartenInHandstapel(_anzahl: number): void {
        let k: number = 0;
        for (let i: number = 0; i < _anzahl; i++) {
            k = Math.floor(Math.random() * ziehstapel.length);
            handstapel.push(ziehstapel[k]);
            let removed: Spielkarte[] = ziehstapel.splice(k, 1);

            placeHandstapel(handstapel[i], i);  //stimmt hier nur, da es durch den loop läuft und die Karten generiert. Aber eben nur stellen aus ziehstapel und nicht aus Handstapel
            //console.log(Ziehstapel)
            //console.log(Handstapel)
        }

        //console.log(Handstapel)
        //let x : number = k  // verändert
        //placeHandstapel(Handstapel[x]) //versuch
        kartenInSpielstapel();

        //placeZiehstapel(Ziehstapel[k]) //wird ausgeführt (also eine Karte ist sichtbar, da dort _k (also die wo im SPielstapel ist) gerendert wird)

        //placeZiehstapel(Ziehstapel[k])

        for (let i: number = 0; i < ziehstapel.length; i++) {
            placeZiehstapel(ziehstapel[i], i);
        }

    }

    function kartenInSpielstapel(): void {
        let i: number = 0;
        let k: number = Math.floor(Math.random() * ziehstapel.length);
        spielstapel.push(ziehstapel[k]);
        let removed: Spielkarte[] = ziehstapel.splice(k, 1);

        placeSpielStapel(spielstapel[i]);

    }

    function placeHandstapel(_k: Spielkarte, _i: number): void { //verändert

        let prodElement: HTMLDivElement = document.createElement("div");
        prodElement.innerHTML = `<fieldset class="Handstapel" id="${_i}">
    <p>${_k.symbol}</p>
    <p>${_k.farbe}</p>
    <p>${_k.zahl}</p>
    </fieldset>`;


        document.getElementById("Handkasten").appendChild(prodElement);
    }

    function placeZiehstapel(_k: Spielkarte, _i: number): void {         //k : number
        let prodElement: HTMLDivElement = document.createElement("div");
        prodElement.innerHTML = `<fieldset class="Ziehstapel" id="${_i}">
    <p>${_k.symbol}</p>
    <p>${_k.farbe}</p>
    <p>${_k.zahl}</p>
    </fieldset>`;


        document.getElementById("Ziehkasten").appendChild(prodElement);
    }

    //k is undefined?

    function placeSpielStapel(_k: Spielkarte): void {
        let prodElement: HTMLDivElement = document.createElement("div");
        prodElement.innerHTML = `<fieldset class="Spielstapel">
    <p>${_k.symbol}</p>
    <p>${_k.farbe}</p>
    <p>${_k.zahl}</p>
    </fieldset>`;


        document.getElementById("Spielkasten").appendChild(prodElement);
    }

    //Neue Aufgabe4

    function init(): void {
        document.getElementById("button").addEventListener("click", sortCard);

        for (let i: number = 0; i < handstapel.length; i++) {
            let handkartenEvent: HTMLFieldSetElement = <HTMLFieldSetElement>document.getElementsByClassName("Handstapel")[i];
            handkartenEvent.addEventListener("click", handstapelInSpielstapel);
        }
    }

    //Von Handstapel auf den Spielstapel

    function handstapelInSpielstapel(_event: Event): void {
        console.log(_event);
        let geklickteKarte: HTMLFieldSetElement = <HTMLFieldSetElement>_event.target;
        let kartenId: string = geklickteKarte.id;    //kartenId ist Id von geklickterKarte
        let kartenIdNummer: number = Number(kartenId);  //kartenId ist ein string und wird in Nummer umgewandelt
        let kartenInSpielstapel: Spielkarte = handstapel[kartenIdNummer]; //aus dem Handstapel wird die Karte mit der gewählten Id gepushed
        spielstapel.push(handstapel[kartenIdNummer]);
        handstapel.splice(kartenIdNummer, 1);
        placeSpielStapel(kartenInSpielstapel);
        placeHandstapelLeeren(kartenIdNummer);
        init();
    }

    function placeHandstapelLeeren(_kartenIdNummer: number): void {
        document.getElementById("Handkasten").innerHTML = "";
        for (let i: number = 0; i < handstapel.length; i++) {
            placeHandstapelAktualisiert(handstapel[i], i)
        }
    }

    function placeHandstapelAktualisiert(_k: Spielkarte, _i: number): void {
        let prodElement = document.createElement("div");
        prodElement.innerHTML = `<fieldset class="Handstapel" id="${_i}">
    <p>${_k.symbol}</p>
    <p>${_k.farbe}</p>
    <p>${_k.zahl}</p>
    </fieldset>`;
        document.getElementById("Handkasten").appendChild(prodElement);
    }

    // von dem Ziehstapel in den Handstapel

    function definieren(): void {
        for (let i: number = 0; i <= ziehstapel.length; i++) {
            let ziehKarte: HTMLFieldSetElement = <HTMLFieldSetElement>document.getElementsByClassName("Ziehstapel")[i];
            ziehKarte.addEventListener("click", vonZiehstapelInHandstapel);
        }
    }

    function vonZiehstapelInHandstapel(): void {
        let k: number = Math.floor(Math.random() * ziehstapel.length);
        handstapel.push(ziehstapel[k]);
        ziehstapel.splice(k, 1);
        document.getElementById("Handkasten").innerHTML = "";
        for (let i: number = 0; i < handstapel.length; i++) {
            placeHandstapelneu(handstapel[i], i)
        }
        init();
        
    }

    function placeHandstapelneu(_k: Spielkarte, _i: number): void {
        let prodElement: HTMLDivElement = document.createElement("div");
        prodElement.innerHTML = `<fieldset class="Handstapel" id="${_i}">
    <p>${_k.symbol}</p>
    <p>${_k.farbe}</p>
    <p>${_k.zahl}</p>
    </fieldset>`;
        document.getElementById("Handkasten").appendChild(prodElement);
    }


    document.addEventListener("keydown", function (event: KeyboardEvent): void {
        if (event.keyCode == 32) {
            vonZiehstapelInHandstapel();
        }
    });

   //Button zum Sortieren - Hab keine Ahnung wie das funktioniert :(

//    document.addEventListener("DOMContentLoaded", buttondrucken)

//    function buttondrucken() : void {
//        let button: HTMLButtonElement = <HTMLButtonElement>document.getElementsByClassName("button")[1];
//           button.addEventListener("click", buttonWurdeGedruckt);
    //}

//    function buttonWurdeGedruckt(event: MouseEvent) : void {
//        console.log("Hallo");
//    }

//handstapel.sort(whatever())

//document.addEventListener("DOMContentLoaded", buttonErstellen);

//function buttonErstellen(): void {
//    let prodElement = document.createElement('div');
//    prodElement.innerHTML = `<button id="button">Sortieren</button> </div>`;
//    document.getElementById("button").appendChild(prodElement);
//}


//function whatever() : void {
//handstapel = [];
//handstapel.sort();
//console.log(handstapel);
//}

//function buttonGedruckt(_event: MouseEvent) {
//	console.log(_event)
//}

//document.getElementById('button').addEventListener("click", sortCard);

function sortCard(_event: Event): void{
	handstapel.sort(sortiereKarten);
	console.log(handstapel);

	document.getElementById("Handkasten").innerHTML = '';
	for (let i: number = 0; i < handstapel.length; i++) {
		placeHandstapelneu(handstapel[i], i);
	}
    init();
}

function sortiereKarten(_a:Spielkarte, _b:Spielkarte): number {
	if (_a.karten_wert_symbol < _b.karten_wert_symbol) {
		return -1;
	}
	if (_a.karten_wert_symbol > _b.karten_wert_symbol) {
		return 1;
	}
    return 0;
   
}



}


